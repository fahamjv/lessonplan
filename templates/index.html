<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
        <link rel="stylesheet" href="{{url_for('static', filename='css/bootstrap.min.css')}}">

        <link rel="stylesheet" href="{{url_for('static', filename='css/footable.bootstrap.css')}}">
        <link rel="stylesheet" href="{{url_for('static', filename='css/footable.paging.css')}}">
    </head>
    <body>
        <div class="container">
                  <div class="columns">
                        <form method="post" action="{{ url_for('add') }}">
                          <div class="form-group">
                            <label for="lesson_code">Lesson Code</label>
                            <input type="text" name="lesson_code" class="form-control" id="lesson_code" aria-describedby="emailHelp" placeholder="lesson code" required>
                          </div>

                          <div class="form-group">
                              <label for="day">Day :</label>
                              <select class="form-control" id="day" name="day" required>
                                <option value="saturday">saturday</option>
                                <option value="sunday">sunday</option>
                                <option value="monday">monday</option>
                                <option value="tuesday">tuesday</option>
                                <option value="wednesday">wednesday</option>
                              </select>
                          </div>


                          <div class="form-group">
                            <label for="start_time">Start Time</label>
                            <input type="time" name="start_time" class="form-control" id="start_time" required>

                            <label for="end_time">End Time</label>
                            <input type="time" name="end_time" class="form-control" id="end_time" required>
                          </div>

                          <button type="submit" class="btn btn-primary">Submit</button>
                        </form>
                </div>
        </div>


        <button id="check" class="btn btn-primary" onclick="check()">Check</button>


        <hr>

        <table id="classes_table" class="table" data-paging="true"></table>



    </body>


    <script src="{{url_for('static', filename='js/jquery-3.4.1.js')}}"></script>
    <script src="{{url_for('static', filename='js/bootstrap.min.js')}}"></script>
    <script src="{{url_for('static', filename='js/footable.js')}}"></script>
    <script src="{{url_for('static', filename='js/footable.paging.js')}}"></script>

    <script>
        jQuery(function($){
            $('.table').footable({
                "columns": $.get('columns'),
                "rows": $.get('rows')
            });
        });
    </script>


    <script>
        function allTableRows(){
            var allrows = []
            $.each($(".table tbody").find("tr"), function () {
                var rr = Number($(this).find("td").html()[0] + $(this).find("td").html()[1])
                allrows.push(rr)
                <!--$(this).css('background-color','red')-->
            });

            return allrows;
        }

        function changeTableRowColor(row1,row2,color){
            $.each($(".table tbody").find("tr"), function () {
                var rr = Number($(this).find("td").html()[0] + $(this).find("td").html()[1])
                if (rr == row1 || rr == row2){
                    $(this).css('background-color',color)
                }
            });
        }


        function check(){


            jQuery.ajax({

                type:"get",
                url: "{{url_for('check')}}",
                success: function(data) {


                    var ft = FooTable.get("#classes_table"),
                        rows = ft.rows.all,
                        total = 0;

                    console.log(data)


                    for (var i in data){
                        let x = data[i]

                        for (var j in x){

                            changeTableRowColor(x[j][0],x[j][1],x[j][2])

                        }

                    }


                    for (var key in rows){
<!--                        console.log(rows[key].val()['id'])-->

<!--                        console.log(rows[key])-->
                    }


                },
                error: function(data) {
                    console.log(data)
                },
            });
        }
    </script>
</html>